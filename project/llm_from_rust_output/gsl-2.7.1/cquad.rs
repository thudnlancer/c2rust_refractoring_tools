use std::f64;
use std::ptr;

pub const GSL_SUCCESS: i32 = 0;
pub const GSL_EDOM: i32 = 1;
pub const GSL_EINVAL: i32 = 4;
pub const GSL_EBADTOL: i32 = 13;
pub const GSL_ENOMEM: i32 = 8;
pub const GSL_EDIVERGE: i32 = 22;

#[derive(Clone, Copy)]
pub struct GslFunction {
    pub function: Option<unsafe extern "C" fn(f64, *mut std::ffi::c_void) -> f64>,
    pub params: *mut std::ffi::c_void,
}

#[derive(Clone, Copy)]
pub struct GslIntegrationCquadIval {
    pub a: f64,
    pub b: f64,
    pub c: [f64; 64],
    pub fx: [f64; 33],
    pub igral: f64,
    pub err: f64,
    pub depth: i32,
    pub rdepth: i32,
    pub ndiv: i32,
}

#[derive(Clone, Copy)]
pub struct GslIntegrationCquadWorkspace {
    pub size: usize,
    pub ivals: *mut GslIntegrationCquadIval,
    pub heap: *mut usize,
}

static XI: [f64; 33] = [
    -1.0,
    -0.99518472667219688624,
    -0.98078528040323044912,
    -0.95694033573220886493,
    -0.92387953251128675612,
    -0.88192126434835502970,
    -0.83146961230254523708,
    -0.77301045336273696082,
    -0.70710678118654752440,
    -0.63439328416364549822,
    -0.55557023301960222475,
    -0.47139673682599764857,
    -0.38268343236508977173,
    -0.29028467725446236764,
    -0.19509032201612826785,
    -0.098017140329560601995,
    0.0,
    0.098017140329560601995,
    0.19509032201612826785,
    0.29028467725446236764,
    0.38268343236508977173,
    0.47139673682599764857,
    0.55557023301960222475,
    0.63439328416364549822,
    0.70710678118654752440,
    0.77301045336273696082,
    0.83146961230254523708,
    0.88192126434835502970,
    0.92387953251128675612,
    0.95694033573220886493,
    0.98078528040323044912,
    0.99518472667219688624,
    1.0,
];

static BEE: [f64; 68] = [
    0.00000000000000e+00,
    2.28868854108532e-01,
    0.00000000000000e+00,
    -8.15740215243451e-01,
    0.00000000000000e+00,
    5.31212715259731e-01,
    0.00000000000000e+00,
    1.38538036812454e-02,
    0.00000000000000e+00,
    3.74405228908818e-02,
    0.00000000000000e+00,
    2.12224115039342e-01,
    0.00000000000000e+00,
    -8.16362644507898e-01,
    0.00000000000000e+00,
    5.35648426691481e-01,
    0.00000000000000e+00,
    1.52417902753662e-03,
    0.00000000000000e+00,
    2.63058840550873e-03,
    0.00000000000000e+00,
    4.15292106318904e-03,
    0.00000000000000e+00,
    6.97106011119775e-03,
    0.00000000000000e+00,
    1.35535708431058e-02,
    0.00000000000000e+00,
    3.52132898424856e-02,
    0.00000000000000e+00,
    2.06946714741884e-01,
    0.00000000000000e+00,
    -8.15674251283876e-01,
    0.00000000000000e+00,
    5.38841175520580e-01,
    0.00000000000000e+00,
    1.84909689577590e-04,
    0.00000000000000e+00,
    2.90936325007499e-04,
    0.00000000000000e+00,
    3.84877750950089e-04,
    0.00000000000000e+00,
    4.86436656735046e-04,
    0.00000000000000e+00,
    6.08688640346879e-04,
    0.00000000000000e+00,
    7.66732830740331e-04,
    0.00000000000000e+00,
    9.82753336104205e-04,
    0.00000000000000e+00,
    1.29359957505615e-03,
    0.00000000000000e+00,
    1.76616363801885e-03,
    0.00000000000000e+00,
    2.53323433039089e-03,
    0.00000000000000e+00,
    3.88872172121956e-03,
    0.00000000000000e+00,
    6.58635106468291e-03,
    0.00000000000000e+00,
    1.30326736343254e-02,
    0.00000000000000e+00,
    3.44353850696714e-02,
    0.00000000000000e+00,
    2.05025409531915e-01,
    0.00000000000000e+00,
    -8.14985893995401e-01,
    0.00000000000000e+00,
    5.40679930965238e-01,
];

static LALPHA: [f64; 33] = [
    5.77350269189626e-01,
    5.16397779494322e-01,
    5.07092552837110e-01,
    5.03952630678970e-01,
    5.02518907629606e-01,
    5.01745206004255e-01,
    5.01280411827603e-01,
    5.00979432868120e-01,
    5.00773395667191e-01,
    5.00626174321759e-01,
    5.00517330712619e-01,
    5.00434593736979e-01,
    5.00370233297676e-01,
    5.00319182924304e-01,
    5.00278009473803e-01,
    5.00244319584578e-01,
    5.00216403386025e-01,
    5.00193012939056e-01,
    5.00173220168024e-01,
    5.00156323280355e-01,
    5.00141783641018e-01,
    5.00129182278347e-01,
    5.00118189340972e-01,
    5.00108542278496e-01,
    5.00100030010004e-01,
    5.00092481273333e-01,
    5.00085755939229e-01,
    5.00079738458365e-01,
    5.00074332862969e-01,
    5.00069458915387e-01,
    5.00065049112355e-01,
    5.00061046334395e-01,
    5.00057401986298e-01,
];

static LGAMMA: [f64; 33] = [
    0.0,
    0.0,
    5.16397779494322e-01,
    5.07092552837110e-01,
    5.03952630678970e-01,
    5.02518907629606e-01,
    5.01745206004255e-01,
    5.01280411827603e-01,
    5.00979432868120e-01,
    5.00773395667191e-01,
    5.00626174321759e-01,
    5.00517330712619e-01,
    5.00434593736979e-01,
    5.00370233297676e-01,
    5.00319182924304e-01,
    5.00278009473803e-01,
    5.00244319584578e-01,
    5.00216403386025e-01,
    5.00193012939056e-01,
    5.00173220168024e-01,
    5.00156323280355e-01,
    5.00141783641018e-01,
    5.00129182278347e-01,
    5.00118189340972e-01,
    5.00108542278496e-01,
    5.00100030010003e-01,
    5.00092481273333e-01,
    5.00085755939229e-01,
    5.00079738458365e-01,
    5.00074332862969e-01,
    5.00069458915387e-01,
    5.00065049112355e-01,
    5.00061046334395e-01,
];

static V1INV: [f64; 25] = [
    0.47140452079103168293e-1,
    0.37712361663282534635,
    0.56568542494923801952,
    0.37712361663282534635,
    0.47140452079103168293e-1,
    -0.81649658092772603273e-1,
    -0.46188021535170061160,
    0.0,
    0.46188021535170061160,
    0.81649658092772603273e-1,
    0.15058465048420853962,
    0.12046772038736683169,
    -0.54210474174315074262,
    0.12046772038736683169,
    0.15058465048420853962,
    -0.21380899352993950775,
    0.30237157840738178177,
    -0.0,
    -0.30237157840738178177,
    0.21380899352993950775,
    0.10774960475223581324,
    -0.21549920950447162648,
    0.21549920950447162648,
    -0.21549920950447162648,
    0.10774960475223581324,
];

static V2INV: [f64; 81] = [
    0.11223917161691230546e-1,
    0.10339219839658349826,
    0.19754094204576565761,
    0.25577315077753587922,
    0.27835314560994251755,
    0.25577315077753587922,
    0.19754094204576565761,
    0.10339219839658349826,
    0.11223917161691230546e-1,
    -0.19440394783993476970e-1,
    -0.16544884625069155470,
    -0.24193725566041460608,
    -0.16953338808305493604,
    0.0,
    0.16953338808305493604,
    0.24193725566041460608,
    0.16544884625069155470,
    0.19440394783993476970e-1,
    0.26466393115406349388e-1,
    0.17766815796285469394,
    0.11316664642449611462,
    -0.16306601003711325980,
    -0.30847037493128779631,
    -0.16306601003711325980,
    0.11316664642449611462,
    0.17766815796285469394,
    0.26466393115406349388e-1,
    -0.32395302049990834508e-1,
    -0.15521142532414866547,
    0.88573492664788602740e-1,
    0.29570405784974857322,
    0.0,
    -0.29570405784974857322,
    -0.88573492664788602740e-1,
    0.15521142532414866547,
    0.32395302049990834508e-1,
    0.41442155673936851246e-1,
    0.98186757907405608245e-1,
    -0.23056908429499411784,
    -0.68047008326360625520e-1,
    0.31797435808002456774,
    -0.68047008326360625520e-1,
    -0.23056908429499411784,
    0.98186757907405608245e-1,
    0.41442155673936851246e-1,
    -0.49981120317798783134e-1,
    -0.24861810572835756217e-1,
    0.23561326072010832539,
    -0.24472785656448415351,
    0.0,
    0.24472785656448415351,
    -0.23561326072010832539,
    0.24861810572835756217e-1,
    0.49981120317798783134e-1,
    0.79691635865674781228e-1,
    -0.95725617891693941833e-1,
    -0.57957553356854386344e-1,
    0.21164072460540271452,
    -0.27529837844505833514,
    0.21164072460540271452,
    -0.57957553356854386344e-1,
    -0.95725617891693941833e-1,
    0.79691635865674781228e-1,
    -0.10894869830716590913,
    0.20131094491947531782,
    -0.15407672674888869038,
    0.83385723639789791384e-1,
    0.0,
    -0.83385723639789791384e-1,
    0.15407672674888869038,
    -0.20131094491947531782,
    0.10894869830716590913,
    0.54581057089643838221e-1,
    -0.10916211417928767644,
    0.10916211417928767644,
    -0.10916211417928767644,
    0.10916211417928767644,
    -0.10916211417928767644,
    0.10916211417928767644,
    -0.10916211417928767644,
    0.54581057089643838221e-1,
];

static V3INV: [f64; 289] = [
    0.27729677693590098996e-2,
    0.26423663180333065153e-1,
    0.53374068493933898312e-1,
    0.77007854739523195947e-1,
    0.98257061072911596869e-1,
    0.11538049741786835604,
    0.12832134344120884559,
    0.13612785914022865001,
    0.13888293186236181317,
    0.13612785914022865001,
    0.12832134344120884559,
    0.11538049741786835604,
    0.98257061072911596869e-1,
    0.77007854739523195947e-1,
    0.53374068493933898312e-1,
    0.26423663180333065153e-1,
    0.27729677693590098996e-2,
    -0.48029210642807413690e-2,
    -0.44887724635478800254e-1,
    -0.85409520147301089416e-1,
    -0.11090267822061423050,
    -0.12033983162705862441,
    -0.11102786862182788886,
    -0.85054870109799336515e-1,
    -0.45998467987742225160e-1,
    0.0,
    0.45998467987742225160e-1,
    0.85054870109799336515e-1,
    0.11102786862182788886,
    0.12033983162705862441,
    0.11090267822061423050,
    0.854095201473