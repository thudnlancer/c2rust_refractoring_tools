use std::f64::consts::{PI, E};
use rand::Rng;

pub fn gsl_ran_landau_pdf(x: f64) -> f64 {
    static P1: [f64; 5] = [
        0.4259894875E0,
        -0.1249762550E0,
        0.3984243700E-1,
        -0.6298287635E-2,
        0.1511162253E-2,
    ];
    static P2: [f64; 5] = [
        0.1788541609E0,
        0.1173957403E0,
        0.1488850518E-1,
        -0.1394989411E-2,
        0.1283617211E-3,
    ];
    static P3: [f64; 5] = [
        0.1788544503E0,
        0.9359161662E-1,
        0.6325387654E-2,
        0.6611667319E-4,
        -0.2031049101E-5,
    ];
    static P4: [f64; 5] = [
        0.9874054407E0,
        0.1186723273E3,
        0.8492794360E3,
        -0.7437792444E3,
        0.4270262186E3,
    ];
    static P5: [f64; 5] = [
        0.1003675074E1,
        0.1675702434E3,
        0.4789711289E4,
        0.2121786767E5,
        -0.2232494910E5,
    ];
    static P6: [f64; 5] = [
        0.1000827619E1,
        0.6649143136E3,
        0.6297292665E5,
        0.4755546998E6,
        -0.5743609109E7,
    ];

    static Q1: [f64; 5] = [
        1.0,
        -0.3388260629E0,
        0.9594393323E-1,
        -0.1608042283E-1,
        0.3778942063E-2,
    ];
    static Q2: [f64; 5] = [
        1.0,
        0.7428795082E0,
        0.3153932961E0,
        0.6694219548E-1,
        0.8790609714E-2,
    ];
    static Q3: [f64; 5] = [
        1.0,
        0.6097809921E0,
        0.2560616665E0,
        0.4746722384E-1,
        0.6957301675E-2,
    ];
    static Q4: [f64; 5] = [
        1.0,
        0.1068615961E3,
        0.3376496214E3,
        0.2016712389E4,
        0.1597063511E4,
    ];
    static Q5: [f64; 5] = [
        1.0,
        0.1569424537E3,
        0.3745310488E4,
        0.9834698876E4,
        0.6692428357E5,
    ];
    static Q6: [f64; 5] = [
        1.0,
        0.6514101098E3,
        0.5697473333E5,
        0.1659174725E6,
        -0.2815759939E7,
    ];

    static A1: [f64; 3] = [
        0.4166666667E-1,
        -0.1996527778E-1,
        0.2709538966E-1,
    ];
    static A2: [f64; 2] = [
        -0.1845568670E1,
        -0.4284640743E1,
    ];

    let v = x;
    if v < -5.5 {
        let u = (v + 1.0).exp();
        0.3989422803 * ((-1.0 / u).exp() / u.sqrt()) * (1.0 + (A1[0] + (A1[1] + A1[2] * u) * u) * u)
    } else if v < -1.0 {
        let u = (-v - 1.0).exp();
        (-u).exp() * u.sqrt() * (P1[0] + (P1[1] + (P1[2] + (P1[3] + P1[4] * v) * v) * v) / 
            (Q1[0] + (Q1[1] + (Q1[2] + (Q1[3] + Q1[4] * v) * v) * v)
    } else if v < 1.0 {
        (P2[0] + (P2[1] + (P2[2] + (P2[3] + P2[4] * v) * v) * v) * v) / 
            (Q2[0] + (Q2[1] + (Q2[2] + (Q2[3] + Q2[4] * v) * v) * v) * v)
    } else if v < 5.0 {
        (P3[0] + (P3[1] + (P3[2] + (P3[3] + P3[4] * v) * v) * v) * v) / 
            (Q3[0] + (Q3[1] + (Q3[2] + (Q3[3] + Q3[4] * v) * v) * v) * v)
    } else if v < 12.0 {
        let u = 1.0 / v;
        u * u * (P4[0] + (P4[1] + (P4[2] + (P4[3] + P4[4] * u) * u) * u) * u) / 
            (Q4[0] + (Q4[1] + (Q4[2] + (Q4[3] + Q4[4] * u) * u) * u) * u)
    } else if v < 50.0 {
        let u = 1.0 / v;
        u * u * (P5[0] + (P5[1] + (P5[2] + (P5[3] + P5[4] * u) * u) * u) * u) / 
            (Q5[0] + (Q5[1] + (Q5[2] + (Q5[3] + Q5[4] * u) * u) * u) * u)
    } else if v < 300.0 {
        let u = 1.0 / v;
        u * u * (P6[0] + (P6[1] + (P6[2] + (P6[3] + P6[4] * u) * u) * u) * u) / 
            (Q6[0] + (Q6[1] + (Q6[2] + (Q6[3] + Q6[4] * u) * u) * u) * u)
    } else {
        let u = 1.0 / (v - v * v.ln() / (v + 1.0));
        u * u * (1.0 + (A2[0] + A2[1] * u) * u)
    }
}

pub fn gsl_ran_landau<R: Rng>(rng: &mut R) -> f64 {
    static F: [f64; 983] = [
        0.0000000,
        00.000000, 00.000000, 00.000000, 00.000000, 00.000000,
        -2.244733, -2.204365, -2.168163, -2.135219, -2.104898,
        -2.076740, -2.050397, -2.025605, -2.002150, -1.979866,
        -1.958612, -1.938275, -1.918760, -1.899984, -1.881879,
        -1.864385, -1.847451, -1.831030, -1.815083, -1.799574,
        -1.784473, -1.769751, -1.755383, -1.741346, -1.727620,
        -1.714187, -1.701029, -1.688130, -1.675477, -1.663057,
        -1.650858, -1.638868, -1.627078, -1.615477, -1.604058,
        -1.592811, -1.581729, -1.570806, -1.560034, -1.549407,
        -1.538919, -1.528565, -1.518339, -1.508237, -1.498254,
        -1.488386, -1.478628, -1.468976, -1.459428, -1.449979,
        -1.440626, -1.431365, -1.422195, -1.413111, -1.404112,
        -1.395194, -1.386356, -1.377594, -1.368906, -1.360291,
        -1.351746, -1.343269, -1.334859, -1.326512, -1.318229,
        -1.310006, -1.301843, -1.293737, -1.285688, -1.277693,
        -1.269752, -1.261863, -1.254024, -1.246235, -1.238494,
        -1.230800, -1.223153, -1.215550, -1.207990, -1.200474,
        -1.192999, -1.185566, -1.178172, -1.170817, -1.163500,
        -1.156220, -1.148977, -1.141770, -1.134598, -1.127459,
        -1.120354, -1.113282, -1.106242, -1.099233, -1.092255,
        -1.085306, -1.078388, -1.071498, -1.064636, -1.057802,
        -1.050996, -1.044215, -1.037461, -1.030733, -1.024029,
        -1.017350, -1.010695, -1.004064, -0.997456, -0.990871,
        -0.984308, -0.977767, -0.971247, -0.964749, -0.958271,
        -0.951813, -0.945375, -0.938957, -0.932558, -0.926178,
        -0.919816, -0.913472, -0.907146, -0.900838, -0.894547,
        -0.888272, -0.882014, -0.875773, -0.869547, -0.863337,
        -0.857142, -0.850963, -0.844798, -0.838648, -0.832512,
        -0.826390, -0.820282, -0.814187, -0.808106, -0.802038,
        -0.795982, -0.789940, -0.783909, -0.777891, -0.771884,
        -0.765889, -0.759906, -0.753934, -0.747973, -0.742023,
        -0.736084, -0.730155, -0.724237, -0.718328, -0.712429,
        -0.706541, -0.700661, -0.694791, -0.688931, -0.683079,
        -0.677236, -0.671402, -0.665576, -0.659759, -0.653950,
        -0.648149, -0.642356, -0.636570, -0.630793, -0.625022,
        -0.619259, -0.613503, -0.607754, -0.602012, -0.596276,
        -0.590548, -0.584825, -0.579109, -0.573399, -0.567695,
        -0.561997, -0.556305, -0.550618, -0.544937, -0.539262,
        -0.533592, -0.527926, -0.522266, -0.516611, -0.510961,
        -0.505315, -0.499674, -0.494037, -0.488405, -0.482777,
        -0.477153, -0.471533, -0.465917, -0.460305, -0.454697,
        -0.449092, -0.443491, -0.437893, -0.432299, -0.426707,
        -0.421119, -0.415534, -0.409951, -0.404372, -0.398795,
        -0.393221, -0.387649, -0.382080, -0.376513, -0.370949,
        -0.365387, -0.359826, -0.354268, -0.348712, -0.343157,
        -0.337604, -0.332053, -0.326503, -0.320955, -0.315408,
        -0.309863, -0.304318, -0.298775, -0.293233, -0.287692,
        -0.282152, -0.276613, -0.271074, -0.265536, -0.259999,
        -0.254462, -0.248926, -0.243389, -0.237854, -0.232318,
        -0.226783, -0.221247, -0.215712, -0.210176, -0.204641,
        -0.199105, -0.193568, -0.188032, -0.182495, -0.176957,
        -0.171419, -0.165880, -0.160341, -0.154800, -0.149259,
        -0.143717, -0.138173, -0.132629, -0.127083, -0.121537,
        -0.115989, -0.110439, -0.104889, -0.099336, -0.093782,
        -0.088227, -0.082670, -0.077111, -0.071550, -0.065987,
        -0.060423, -0.054856, -0.049288, -0.043717, -0.038144,
        -0.032569, -0.026991, -0.021411, -0.015828, -0.010243,
        -0.004656, 00.000934, 00.006527, 00.012123, 00.017722,
        00.023323, 00.028928, 00.034535, 00.040146, 00.045759,
        00.051376, 00.056997, 00.062620, 00.068247, 00.073877,
        00.079511, 00.085149, 00.090790, 00.096435, 00.102083,
        00.107736, 00.113392, 00.119052, 00.124716, 00.130385,
        00.136057, 00.141734, 00.147414, 00.153100, 00.158789,
        00.164483, 00.170181, 00.175884, 00.181592, 00.187304,
        00.193021, 00.198743, 00.204469, 00.210201, 00.215937,
        00.221678, 00.227425, 00.233177, 00.238933, 00.244696,
        00.250463, 00.256236, 00.262014, 00.267798, 00.273587,
        00.279382, 00.285183, 00.290989, 00.296801, 00.302619,
        00.308443, 00.314273, 00.320109, 00.325951, 00.331799,
        00.337654, 00.343515, 00.349382, 00.355255, 00.361135,
        00.367022, 00.372915, 00.378815, 00.384721, 00.390634,
        00.396554, 00.402481, 00.408415, 00.414356, 00.420304,
        00.426260, 00.432222, 00.438192, 00.444169, 00.450153,
        00.456145, 00.462144, 00.468151, 00.474166, 00.480188,
        00.486218, 00.492256, 00.498