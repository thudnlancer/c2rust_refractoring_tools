use std::f64::consts::PI;
use std::f64::EPSILON;
use std::mem;

const GLAWSIZE: usize = 27;

#[derive(Debug)]
struct GlfixedTable {
    n: usize,
    x: Vec<f64>,
    w: Vec<f64>,
    precomputed: bool,
}

static GLAW: [GlfixedTable; GLAWSIZE] = [
    GlfixedTable {
        n: 2,
        x: vec![0.5773502691896257645091488],
        w: vec![1.0000000000000000000000000],
        precomputed: true,
    },
    GlfixedTable {
        n: 3,
        x: vec![0.0000000000000000000000000, 0.7745966692414833770358531],
        w: vec![0.8888888888888888888888889, 0.5555555555555555555555556],
        precomputed: true,
    },
    GlfixedTable {
        n: 4,
        x: vec![0.3399810435848562648026658, 0.8611363115940525752239465],
        w: vec![0.6521451548625461426269361, 0.3478548451374538573730639],
        precomputed: true,
    },
    GlfixedTable {
        n: 6,
        x: vec![
            0.2386191860831969086305017,
            0.6612093864662645136613996,
            0.9324695142031520278123016,
        ],
        w: vec![
            0.4679139345726910473898703,
            0.3607615730481386075698335,
            0.1713244923791703450402961,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 8,
        x: vec![
            0.1834346424956498049394761,
            0.5255324099163289858177390,
            0.7966664774136267395915539,
            0.9602898564975362316835609,
        ],
        w: vec![
            0.3626837833783619829651504,
            0.3137066458778872873379622,
            0.2223810344533744705443560,
            0.1012285362903762591525314,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 10,
        x: vec![
            0.1488743389816312108848260,
            0.4333953941292471907992659,
            0.6794095682990244062343274,
            0.8650633666889845107320967,
            0.9739065285171717200779640,
        ],
        w: vec![
            0.2955242247147528701738930,
            0.2692667193099963550912269,
            0.2190863625159820439955349,
            0.1494513491505805931457763,
            0.0666713443086881375935688,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 12,
        x: vec![
            0.1252334085114689154724414,
            0.3678314989981801937526915,
            0.5873179542866174472967024,
            0.7699026741943046870368938,
            0.9041172563704748566784659,
            0.9815606342467192506905491,
        ],
        w: vec![
            0.2491470458134027850005624,
            0.2334925365383548087608499,
            0.2031674267230659217490645,
            0.1600783285433462263346525,
            0.1069393259953184309602547,
            0.0471753363865118271946160,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 14,
        x: vec![
            0.1080549487073436620662447,
            0.3191123689278897604356718,
            0.5152486363581540919652907,
            0.6872929048116854701480198,
            0.8272013150697649931897947,
            0.9284348836635735173363911,
            0.9862838086968123388415973,
        ],
        w: vec![
            0.2152638534631577901958764,
            0.2051984637212956039659241,
            0.1855383974779378137417166,
            0.1572031671581935345696019,
            0.1215185706879031846894148,
            0.0801580871597602098056333,
            0.0351194603317518630318329,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 16,
        x: vec![
            0.0950125098376374401853193,
            0.2816035507792589132304605,
            0.4580167776572273863424194,
            0.6178762444026437484466718,
            0.7554044083550030338951012,
            0.8656312023878317438804679,
            0.9445750230732325760779884,
            0.9894009349916499325961542,
        ],
        w: vec![
            0.1894506104550684962853967,
            0.1826034150449235888667637,
            0.1691565193950025381893121,
            0.1495959888165767320815017,
            0.1246289712555338720524763,
            0.0951585116824927848099251,
            0.0622535239386478928628438,
            0.0271524594117540948517806,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 18,
        x: vec![
            0.0847750130417353012422619,
            0.2518862256915055095889729,
            0.4117511614628426460359318,
            0.5597708310739475346078715,
            0.6916870430603532078748911,
            0.8037049589725231156824175,
            0.8926024664975557392060606,
            0.9558239495713977551811959,
            0.9915651684209309467300160,
        ],
        w: vec![
            0.1691423829631435918406565,
            0.1642764837458327229860538,
            0.1546846751262652449254180,
            0.1406429146706506512047313,
            0.1225552067114784601845191,
            0.1009420441062871655628140,
            0.0764257302548890565291297,
            0.0497145488949697964533349,
            0.0216160135264833103133427,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 20,
        x: vec![
            0.0765265211334973337546404,
            0.2277858511416450780804962,
            0.3737060887154195606725482,
            0.5108670019508270980043641,
            0.6360536807265150254528367,
            0.7463319064601507926143051,
            0.8391169718222188233945291,
            0.9122344282513259058677524,
            0.9639719272779137912676661,
            0.9931285991850949247861224,
        ],
        w: vec![
            0.1527533871307258506980843,
            0.1491729864726037467878287,
            0.1420961093183820513292983,
            0.1316886384491766268984945,
            0.1181945319615184173123774,
            0.1019301198172404350367501,
            0.0832767415767047487247581,
            0.0626720483341090635695065,
            0.0406014298003869413310400,
            0.0176140071391521183118620,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 32,
        x: vec![
            0.0483076656877383162348126,
            0.1444719615827964934851864,
            0.2392873622521370745446032,
            0.3318686022821276497799168,
            0.4213512761306353453641194,
            0.5068999089322293900237475,
            0.5877157572407623290407455,
            0.6630442669302152009751152,
            0.7321821187402896803874267,
            0.7944837959679424069630973,
            0.8493676137325699701336930,
            0.8963211557660521239653072,
            0.9349060759377396891709191,
            0.9647622555875064307738119,
            0.9856115115452683354001750,
            0.9972638618494815635449811,
        ],
        w: vec![
            0.0965400885147278005667648,
            0.0956387200792748594190820,
            0.0938443990808045656391802,
            0.0911738786957638847128686,
            0.0876520930044038111427715,
            0.0833119242269467552221991,
            0.0781938957870703064717409,
            0.0723457941088485062253994,
            0.0658222227763618468376501,
            0.0586840934785355471452836,
            0.0509980592623761761961632,
            0.0428358980222266806568786,
            0.0342738629130214331026877,
            0.0253920653092620594557526,
            0.0162743947309056706051706,
            0.0070186100094700966004071,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 64,
        x: vec![
            0.0243502926634244325089558,
            0.0729931217877990394495429,
            0.1214628192961205544703765,
            0.1696444204239928180373136,
            0.2174236437400070841496487,
            0.2646871622087674163739642,
            0.3113228719902109561575127,
            0.3572201583376681159504426,
            0.4022701579639916036957668,
            0.4463660172534640879849477,
            0.4894031457070529574785263,
            0.5312794640198945456580139,
            0.5718956462026340342838781,
            0.6111553551723932502488530,
            0.6489654712546573398577612,
            0.6852363130542332425635584,
            0.7198818501716108268489402,
            0.7528199072605318966118638,
            0.7839723589433414076102205,
            0.8132653151227975597419233,
            0.8406292962525803627516915,
            0.8659993981540928197607834,
            0.8893154459951141058534040,
            0.9105221370785028057563807,
            0.9295691721319395758214902,
            0.9464113748584028160624815,
            0.9610087996520537189186141,
            0.9733268277899109637418535,
            0.9833362538846259569312993,
            0.9910133714767443207393824,
            0.9963401167719552793469245,
            0.9993050417357721394569056,
        ],
        w: vec![
            0.0486909570091397203833654,
            0.0485754674415034269347991,
            0.0483447622348029571697695,
            0.0479993885964583077281262,
            0.0475401657148303086622822,
            0.0469681828162100173253263,
            0.0462847965813144172959532,
            0.0454916279274181444797710,
            0.0445905581637565630601347,
            0.0435837245293234533768279,
            0.0424735151236535890073398,
            0.0412625632426235286101563,
            0.0399537411327203413866569,
            0.0385501531786156291289625,
            0.0370551285402400460404151,
            0.0354722132568823838106931,
            0.0338051618371416093915655,
            0.0320579283548515535854675,
            0.0302346570724024788679741,
            0.0283396726142594832275113,
            0.0263774697150546586716918,
            0.0243527025687108733381776,
            0.0222701738083832541592983,
            0.0201348231535302093723403,
            0.0179517157756973430850453,
            0.0157260304760247193219660,
            0.0134630478967186425980608,
            0.0111681394601311288185905,
            0.0088467598263639477230309,
            0.0065044579689783628561174,
            0.0041470332605624676352875,
            0.0017832807216964329472961,
        ],
        precomputed: true,
    },
    GlfixedTable {
        n: 96,
        x: vec![
            0.0162767448496029695791346,
            0.0488129851360497311119582,
            0.0812974954644255589944713,
            0.1136958501106659209112081,
            0.1459737146548969419891073,
            0.1780968823676186027594026,
            0.2100313104605672036028472,
            0.2417431561638400123279319,
            0.2731988125910491414872722,
            0.3043649443544963530239298,
            0.3352085228926254226163256,
            0.3656968614723136350308956,
            0.3957976498289086032850002,
            0.4254789884073005453648192,
            0.4547094221677430086356761,
            0.4834579739205963597684056,
            0.5116941771546676735855097,
            0.5393881083243574362268026,
            0.5665104185613971684042502,
            0.5930323647775720806835558,
            0.6189258401254685703863693,
            0.6441634037849671067984124,
            0.6687183100439161539525572,
            0.6925645366421715613442458,
            0.7156768123489676262251441,
            0.7380306437444001328511657,
            0.7596023411766474987029704,
            0.7803690438674332176036045,
            0.8003087441391408172287961,
            0.8194003107379316755389996,
            0.8376235112281871214943028,
            0.8549590334346014554627870,
            0.8713885059092965028737748,
            0.8868945174024204160568774,
            0.9014606353158523413192327,
            0.9150714231208980742058845,
            0.9277124567223086909646905,
            0.9393703397527552169318574,
            0.9500327177844376357560989,
            0.9596882914487425393000680,
            0.9683268284632642121736594,
            0.9759391745851364664526010,
            0.9825172635630146774470458,
            0.9880541263296237994807628,
            0.9925439003237626245718923,
            0.9959818429872092906503991,
            0.9983643758631816777241494,
            0.9996895038832307668276901,
        ],
        w: vec![
            0.0325506144923631662419614,
            0.0325161187138688359872055,
            0.0324471637140642693640128,
            0.0323438225685759284287748,
            0.0322062047940302506686671,
            0.0320344562319926632181390,
            0.0318287588944110065347537,
            0.0315893307707271685580207,
            0.0313164255968613558127843,
            0.0310103325863138374232498,
            0.0306713761236691490142288,
            0.0302999154208275937940888,
            0.0298963441363283859843881,
            0.029461089958167