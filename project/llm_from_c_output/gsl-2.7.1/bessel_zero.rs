use std::f64::consts::PI;

const GSL_DBL_EPSILON: f64 = 2.2204460492503131e-16;

#[derive(Debug, Clone, Copy)]
pub struct SfResult {
    pub val: f64,
    pub err: f64,
}

impl SfResult {
    pub fn new(val: f64, err: f64) -> Self {
        Self { val, err }
    }
}

const COEF_JNU1_A: [f64; 24] = [
    3.801775243633476,
    1.360704737511120,
    -0.030707710261106,
    0.004526823746202,
    -0.000808682832134,
    0.000159218792489,
    -0.000033225189761,
    0.000007205599763,
    -0.000001606110397,
    0.000000365439424,
    -0.000000084498039,
    0.000000019793815,
    -0.000000004687054,
    0.000000001120052,
    -0.000000000269767,
    0.000000000065420,
    -0.000000000015961,
    0.000000000003914,
    -0.000000000000965,
    0.000000000000239,
    -0.000000000000059,
    0.000000000000015,
    -0.000000000000004,
    0.000000000000001,
];

const COEF_JNU1_B: [f64; 15] = [
    1.735063412537096,
    0.784478100951978,
    0.048881473180370,
    -0.000578279783021,
    -0.000038984957864,
    0.000005758297879,
    -0.000000327583229,
    -0.000000003853878,
    0.000000002284653,
    -0.000000000153079,
    -0.000000000000895,
    0.000000000000283,
    0.000000000000043,
    0.000000000000010,
    -0.000000000000003,
];

const COEF_JNU2_A: [f64; 19] = [
    6.992370244046161,
    1.446379282056534,
    -0.023458616207293,
    0.002172149448700,
    -0.000246262775620,
    0.000030990180959,
    -0.000004154183047,
    0.000000580766328,
    -0.000000083648175,
    0.000000012317355,
    -0.000000001844887,
    0.000000000280076,
    -0.000000000042986,
    0.000000000006658,
    -0.000000000001039,
    0.000000000000163,
    -0.000000000000026,
    0.000000000000004,
    -0.000000000000001,
];

const COEF_JNU2_B: [f64; 19] = [
    2.465611864263400,
    1.607952988471069,
    0.138758034431497,
    -0.003687791182054,
    -0.000051276007868,
    0.000045113570749,
    -0.000007579172152,
    0.000000736469208,
    -0.000000011118527,
    -0.000000011919884,
    0.000000002696788,
    -0.000000000314488,
    0.000000000008124,
    0.000000000005211,
    -0.000000000001292,
    0.000000000000158,
    -0.000000000000004,
    -0.000000000000003,
    0.000000000000001,
];

const COEF_JNU3_A: [f64; 19] = [
    10.869647065239236,
    2.177524286141710,
    -0.034822817125293,
    0.003167249102413,
    -0.000353960349344,
    0.000044039086085,
    -0.000005851380981,
    0.000000812575483,
    -0.000000116463617,
    0.000000017091246,
    -0.000000002554376,
    0.000000000387335,
    -0.000000000059428,
    0.000000000009207,
    -0.000000000001438,
    0.000000000000226,
    -0.000000000000036,
    0.000000000000006,
    -0.000000000000001,
];

const COEF_JNU3_B: [f64; 19] = [
    2.522816775173244,
    1.673199424973720,
    0.146431617506314,
    -0.004049001763912,
    -0.000039517767244,
    0.000048781729288,
    -0.000008729705695,
    0.000000928737310,
    -0.000000028388244,
    -0.000000012927432,
    0.000000003441008,
    -0.000000000471695,
    0.000000000025590,
    0.000000000005502,
    -0.000000000001881,
    0.000000000000295,
    -0.000000000000020,
    -0.000000000000003,
    0.000000000000001,
];

const COEF_JNU4_A: [f64; 19] = [
    14.750310252773009,
    2.908010932941708,
    -0.046093293420315,
    0.004147172321412,
    -0.000459092310473,
    0.000056646951906,
    -0.000007472351546,
    0.000001031210065,
    -0.000000147008137,
    0.000000021475218,
    -0.000000003197208,
    0.000000000483249,
    -0.000000000073946,
    0.000000000011431,
    -0.000000000001782,
    0.000000000000280,
    -0.000000000000044,
    0.000000000000007,
    -0.000000000000001,
];

const COEF_JNU4_B: [f64; 19] = [
    2.551681323117914,
    1.706177978336572,
    0.150357658406131,
    -0.004234001378590,
    -0.000033854229898,
    0.000050763551485,
    -0.000009337464057,
    0.000001029717834,
    -0.000000037474196,
    -0.000000013450153,
    0.000000003836180,
    -0.000000000557404,
    0.000000000035748,
    0.000000000005487,
    -0.000000000002187,
    0.000000000000374,
    -0.000000000000031,
    -0.000000000000003,
    0.000000000000001,
];

const COEF_JNU5_A: [f64; 19] = [
    18.632261081028211,
    3.638249012596966,
    -0.057329705998828,
    0.005121709126820,
    -0.000563325259487,
    0.000069100826174,
    -0.000009066603030,
    0.000001245181383,
    -0.000000176737282,
    0.000000025716695,
    -0.000000003815184,
    0.000000000574839,
    -0.000000000087715,
    0.000000000013526,
    -0.000000000002104,
    0.000000000000330,
    -0.000000000000052,
    0.000000000000008,
    -0.000000000000001,
];

const COEF_JNU5_B: [f64; 19] = [
    2.569079487591442,
    1.726073360882134,
    0.152740776809531,
    -0.004346449660148,
    -0.000030512461856,
    0.000052000821080,
    -0.000009713343981,
    0.000001091997863,
    -0.000000043061707,
    -0.000000013779413,
    0.000000004082870,
    -0.000000000611259,
    0.000000000042242,
    0.000000000005448,
    -0.000000000002377,
    0.000000000000424,
    -0.000000000000038,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU6_A: [f64; 19] = [
    22.514836143374042,
    4.368367257557198,
    -0.068550155285562,
    0.006093776505822,
    -0.000667152784957,
    0.000081486022398,
    -0.000010649011647,
    0.000001457089679,
    -0.000000206105082,
    0.000000029894724,
    -0.000000004422012,
    0.000000000664471,
    -0.000000000101140,
    0.000000000015561,
    -0.000000000002416,
    0.000000000000378,
    -0.000000000000060,
    0.000000000000009,
    -0.000000000000002,
];

const COEF_JNU6_B: [f64; 19] = [
    2.580710285494837,
    1.739380728566154,
    0.154340696401691,
    -0.004422028860168,
    -0.000028305272624,
    0.000052845975269,
    -0.000009968794373,
    0.000001134252926,
    -0.000000046841241,
    -0.000000014007555,
    0.000000004251816,
    -0.000000000648213,
    0.000000000046728,
    0.000000000005414,
    -0.000000000002508,
    0.000000000000459,
    -0.000000000000043,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU7_A: [f64; 19] = [
    26.397760539730869,
    5.098418721711790,
    -0.079761896398948,
    0.007064521280487,
    -0.000770766522482,
    0.000093835449636,
    -0.000012225308542,
    0.000001667939800,
    -0.000000235288157,
    0.000000034040347,
    -0.000000005023142,
    0.000000000753101,
    -0.000000000114389,
    0.000000000017564,
    -0.000000000002722,
    0.000000000000425,
    -0.000000000000067,
    0.000000000000011,
    -0.000000000000002,
];

const COEF_JNU7_B: [f64; 19] = [
    2.589033335856773,
    1.748907007612678,
    0.155488900387653,
    -0.004476317805688,
    -0.000026737952924,
    0.000053459680946,
    -0.000010153699240,
    0.000001164804272,
    -0.000000049566917,
    -0.000000014175403,
    0.000000004374840,
    -0.000000000675135,
    0.000000000050004,
    0.000000000005387,
    -0.000000000002603,
    0.000000000000485,
    -0.000000000000047,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU8_A: [f64; 19] = [
    30.280900001606662,
    5.828429205461221,
    -0.090968381181069,
    0.008034479731033,
    -0.000874254899080,
    0.000106164151611,
    -0.000013798098749,
    0.000001878187386,
    -0.000000264366627,
    0.000000038167685,
    -0.000000005621060,
    0.000000000841165,
    -0.000000000127538,
    0.000000000019550,
    -0.000000000003025,
    0.000000000000472,
    -0.000000000000074,
    0.000000000000012,
    -0.000000000000002,
];

const COEF_JNU8_B: [f64; 19] = [
    2.595283877150078,
    1.756063044986928,
    0.156352972371030,
    -0.004517201896761,
    -0.000025567187878,
    0.000053925472558,
    -0.000010293734486,
    0.000001187923085,
    -0.000000051625122,
    -0.000000014304212,
    0.000000004468450,
    -0.000000000695620,
    0.000000000052500,
    0.000000000005367,
    -0.000000000002676,
    0.000000000000505,
    -0.000000000000050,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU9_A: [f64; 19] = [
    34.164181213238386,
    6.558412747925228,
    -0.102171455365016,
    0.009003934361201,
    -0.000977663914535,
    0.000118479876579,
    -0.000015368714220,
    0.000002088064285,
    -0.000000293381154,
    0.000000042283900,
    -0.000000006217033,
    0.000000000928887,
    -0.000000000140627,
    0.000000000021526,
    -0.000000000003326,
    0.000000000000518,
    -0.000000000000081,
    0.000000000000013,
    -0.000000000000002,
];

const COEF_JNU9_B: [f64; 19] = [
    2.600150240905079,
    1.761635491694032,
    0.157026743724010,
    -0.004549100368716,
    -0.000024659248617,
    0.000054291035068,
    -0.000010403464334,
    0.000001206027524,
    -0.000000053234089,
    -0.000000014406241,
    0.000000004542078,
    -0.000000000711728,
    0.000000000054464,
    0.000000000005350,
    -0.000000000002733,
    0.000000000000521,
    -0.000000000000052,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU10_A: [f64; 20] = [
    38.047560766184647,
    7.288377637926008,
    -0.113372193277897,
    0.009973047509098,
    -0.001081019701335,
    0.000130786983847,
    -0.000016937898538,
    0.000002297699179,
    -0.000000322354218,
    0.000000046392941,
    -0.000000006811759,
    0.000000001016395,
    -0.000000000153677,
    0.000000000023486,
    -0.000000000003616,
    0.000000000000561,
    -0.000000000000095,
    0.000000000000027,
    -0.000000000000013,
    0.000000000000005,
];

const COEF_JNU10_B: [f64; 19] = [
    2.604046346867949,
    1.766097596481182,
    0.157566834446511,
    -0.004574682244089,
    -0.000023934500688,
    0.000054585558231,
    -0.000010491765415,
    0.000001220589364,
    -0.000000054526331,
    -0.000000014489078,
    0.000000004601510,
    -0.000000000724727,
    0.000000000056049,
    0.000000000005337,
    -0.000000000002779,
    0.000000000000533,
    -0.000000000000054,
    -0.000000000000002,
    0.000000000000002,
];

const COEF_JNU11_A: [f64; 27] =