use md5::{Md5, Digest};
use std::ptr;

static WP: [[u8; 4]; 2048] = [
    [b'A', 0, 0, 0],
    [b'A', b'B', b'E', 0],
    [b'A', b'C', b'E', 0],
    [b'A', b'C', b'T', 0],
    [b'A', b'D', 0, 0],
    [b'A', b'D', b'A', 0],
    [b'A', b'D', b'D', 0],
    [b'A', b'G', b'O', 0],
    [b'A', b'I', b'D', 0],
    [b'A', b'I', b'M', 0],
    [b'A', b'I', b'R', 0],
    [b'A', b'L', b'L', 0],
    [b'A', b'L', b'P', 0],
    [b'A', b'M', 0, 0],
    [b'A', b'M', b'Y', 0],
    [b'A', b'N', 0, 0],
    [b'A', b'N', b'A', 0],
    [b'A', b'N', b'D', 0],
    [b'A', b'N', b'N', 0],
    [b'A', b'N', b'T', 0],
    [b'A', b'N', b'Y', 0],
    [b'A', b'P', b'E', 0],
    [b'A', b'P', b'S', 0],
    [b'A', b'P', b'T', 0],
    [b'A', b'R', b'C', 0],
    [b'A', b'R', b'E', 0],
    [b'A', b'R', b'K', 0],
    [b'A', b'R', b'M', 0],
    [b'A', b'R', b'T', 0],
    [b'A', b'S', 0, 0],
    [b'A', b'S', b'H', 0],
    [b'A', b'S', b'K', 0],
    [b'A', b'T', 0, 0],
    [b'A', b'T', b'E', 0],
    [b'A', b'U', b'G', 0],
    [b'A', b'U', b'K', 0],
    [b'A', b'V', b'E', 0],
    [b'A', b'W', b'E', 0],
    [b'A', b'W', b'K', 0],
    [b'A', b'W', b'L', 0],
    [b'A', b'W', b'N', 0],
    [b'A', b'X', 0, 0],
    [b'A', b'Y', b'E', 0],
    [b'B', b'A', b'D', 0],
    [b'B', b'A', b'G', 0],
    [b'B', b'A', b'H', 0],
    [b'B', b'A', b'M', 0],
    [b'B', b'A', b'N', 0],
    [b'B', b'A', b'R', 0],
    [b'B', b'A', b'T', 0],
    [b'B', b'A', b'Y', 0],
    [b'B', b'E', 0, 0],
    [b'B', b'E', b'D', 0],
    [b'B', b'E', b'E', 0],
    [b'B', b'E', b'G', 0],
    [b'B', b'E', b'N', 0],
    [b'B', b'E', b'T', 0],
    [b'B', b'E', b'Y', 0],
    [b'B', b'I', b'B', 0],
    [b'B', b'I', b'D', 0],
    [b'B', b'I', b'G', 0],
    [b'B', b'I', b'N', 0],
    [b'B', b'I', b'T', 0],
    [b'B', b'O', b'B', 0],
    [b'B', b'O', b'G', 0],
    [b'B', b'O', b'N', 0],
    [b'B', b'O', b'O', 0],
    [b'B', b'O', b'P', 0],
    [b'B', b'O', b'W', 0],
    [b'B', b'O', b'Y', 0],
    [b'B', b'U', b'B', 0],
    [b'B', b'U', b'D', 0],
    [b'B', b'U', b'G', 0],
    [b'B', b'U', b'M', 0],
    [b'B', b'U', b'N', 0],
    [b'B', b'U', b'S', 0],
    [b'B', b'U', b'T', 0],
    [b'B', b'U', b'Y', 0],
    [b'B', b'Y', 0, 0],
    [b'B', b'Y', b'E', 0],
    [b'C', b'A', b'B', 0],
    [b'C', b'A', b'L', 0],
    [b'C', b'A', b'M', 0],
    [b'C', b'A', b'N', 0],
    [b'C', b'A', b'P', 0],
    [b'C', b'A', b'R', 0],
    [b'C', b'A', b'T', 0],
    [b'C', b'A', b'W', 0],
    [b'C', b'O', b'D', 0],
    [b'C', b'O', b'G', 0],
    [b'C', b'O', b'L', 0],
    [b'C', b'O', b'N', 0],
    [b'C', b'O', b'O', 0],
    [b'C', b'O', b'P', 0],
    [b'C', b'O', b'T', 0],
    [b'C', b'O', b'W', 0],
    [b'C', b'O', b'Y', 0],
    [b'C', b'R', b'Y', 0],
    [b'C', b'U', b'B', 0],
    [b'C', b'U', b'E', 0],
    [b'C', b'U', b'P', 0],
    [b'C', b'U', b'R', 0],
    [b'C', b'U', b'T', 0],
    [b'D', b'A', b'B', 0],
    [b'D', b'A', b'D', 0],
    [b'D', b'A', b'M', 0],
    [b'D', b'A', b'N', 0],
    [b'D', b'A', b'R', 0],
    [b'D', b'A', b'Y', 0],
    [b'D', b'E', b'E', 0],
    [b'D', b'E', b'L', 0],
    [b'D', b'E', b'N', 0],
    [b'D', b'E', b'S', 0],
    [b'D', b'E', b'W', 0],
    [b'D', b'I', b'D', 0],
    [b'D', b'I', b'E', 0],
    [b'D', b'I', b'G', 0],
    [b'D', b'I', b'N', 0],
    [b'D', b'I', b'P', 0],
    [b'D', b'O', 0, 0],
    [b'D', b'O', b'E', 0],
    [b'D', b'O', b'G', 0],
    [b'D', b'O', b'N', 0],
    [b'D', b'O', b'T', 0],
    [b'D', b'O', b'W', 0],
    [b'D', b'R', b'Y', 0],
    [b'D', b'U', b'B', 0],
    [b'D', b'U', b'D', 0],
    [b'D', b'U', b'E', 0],
    [b'D', b'U', b'G', 0],
    [b'D', b'U', b'N', 0],
    [b'E', b'A', b'R', 0],
    [b'E', b'A', b'T', 0],
    [b'E', b'D', 0, 0],
    [b'E', b'E', b'L', 0],
    [b'E', b'G', b'G', 0],
    [b'E', b'G', b'O', 0],
    [b'E', b'L', b'I', 0],
    [b'E', b'L', b'K', 0],
    [b'E', b'L', b'M', 0],
    [b'E', b'L', b'Y', 0],
    [b'E', b'M', 0, 0],
    [b'E', b'N', b'D', 0],
    [b'E', b'S', b'T', 0],
    [b'E', b'T', b'C', 0],
    [b'E', b'V', b'A', 0],
    [b'E', b'V', b'E', 0],
    [b'E', b'W', b'E', 0],
    [b'E', b'Y', b'E', 0],
    [b'F', b'A', b'D', 0],
    [b'F', b'A', b'N', 0],
    [b'F', b'A', b'R', 0],
    [b'F', b'A', b'T', 0],
    [b'F', b'A', b'Y', 0],
    [b'F', b'E', b'D', 0],
    [b'F', b'E', b'E', 0],
    [b'F', b'E', b'W', 0],
    [b'F', b'I', b'B', 0],
    [b'F', b'I', b'G', 0],
    [b'F', b'I', b'N', 0],
    [b'F', b'I', b'R', 0],
    [b'F', b'I', b'T', 0],
    [b'F', b'L', b'O', 0],
    [b'F', b'L', b'Y', 0],
    [b'F', b'O', b'E', 0],
    [b'F', b'O', b'G', 0],
    [b'F', b'O', b'R', 0],
    [b'F', b'R', b'Y', 0],
    [b'F', b'U', b'M', 0],
    [b'F', b'U', b'N', 0],
    [b'F', b'U', b'R', 0],
    [b'G', b'A', b'B', 0],
    [b'G', b'A', b'D', 0],
    [b'G', b'A', b'G', 0],
    [b'G', b'A', b'L', 0],
    [b'G', b'A', b'M', 0],
    [b'G', b'A', b'P', 0],
    [b'G', b'A', b'S', 0],
    [b'G', b'A', b'Y', 0],
    [b'G', b'E', b'E', 0],
    [b'G', b'E', b'L', 0],
    [b'G', b'E', b'M', 0],
    [b'G', b'E', b'T', 0],
    [b'G', b'I', b'G', 0],
    [b'G', b'I', b'L', 0],
    [b'G', b'I', b'N', 0],
    [b'G', b'O', 0, 0],
    [b'G', b'O', b'T', 0],
    [b'G', b'U', b'M', 0],
    [b'G', b'U', b'N', 0],
    [b'G', b'U', b'S', 0],
    [b'G', b'U', b'T', 0],
    [b'G', b'U', b'Y', 0],
    [b'G', b'Y', b'M', 0],
    [b'G', b'Y', b'P', 0],
    [b'H', b'A', 0, 0],
    [b'H', b'A', b'D', 0],
    [b'H', b'A', b'L', 0],
    [b'H', b'A', b'M', 0],
    [b'H', b'A', b'N', 0],
    [b'H', b'A', b'P', 0],
    [b'H', b'A', b'S', 0],
    [b'H', b'A', b'T', 0],
    [b'H', b'A', b'W', 0],
    [b'H', b'A', b'Y', 0],
    [b'H', b'E', 0, 0],
    [b'H', b'E', b'M', 0],
    [b'H', b'E', b'N', 0],
    [b'H', b'E', b'R', 0],
    [b'H', b'E', b'W', 0],
    [b'H', b'E', b'Y', 0],
    [b'H', b'I', 0, 0],
    [b'H', b'I', b'D', 0],
    [b'H', b'I', b'M', 0],
    [b'H', b'I', b'P', 0],
    [b'H', b'I', b'S', 0],
    [b'H', b'I', b'T', 0],
    [b'H', b'O', 0, 0],
    [b'H', b'O', b'B', 0],
    [b'H', b'O', b'C', 0],
    [b'H', b'O', b'E', 0],
    [b'H', b'O', b'G', 0],
    [b'H', b'O', b'P', 0],
    [b'H', b'O', b'T', 0],
    [b'H', b'O', b'W', 0],
    [b'H', b'U', b'B', 0],
    [b'H', b'U', b'E', 0],
    [b'H', b'U', b'G', 0],
    [b'H', b'U', b'H', 0],
    [b'H', b'U', b'M', 0],
    [b'H', b'U', b'T', 0],
    [b'I', 0, 0, 0],
    [b'I', b'C', b'Y', 0],
    [b'I', b'D', b'A', 0],
    [b'I', b'F', 0, 0],
    [b'I', b'K', b'E', 0],
    [b'I', b'L', b'L', 0],
    [b'I', b'N', b'K', 0],
    [b'I', b'N', b'N', 0],
    [b'I', b'O', 0, 0],
    [b'I', b'O', b'N', 0],
    [b'I', b'Q', 0, 0],
    [b'I', b'R', b'A', 0],
    [b'I', b'R', b'E', 0],
    [b'I', b'R', b'K', 0],
    [b'I', b'S', 0, 0],
    [b'I', b'T', 0, 0],
    [b'I', b'T', b'S', 0],
    [b'I', b'V', b'Y', 0],
    [b'J', b'A', b'B', 0],
    [b'J', b'A', b'G', 0],
    [b'J', b'A', b'M', 0],
    [b'J', b'A', b'N', 0],
    [b'J', b'A', b'R', 0],
    [b'J', b'A', b'W', 0],
    [b'J', b'A', b'Y', 0],
    [b'J', b'E', b'T', 0],
    [b'J', b'I', b'G', 0],
    [b'J', b'I', b'M', 0],
    [b'J', b'O', 0, 0],
    [b'J', b'O', b'B', 0],
    [b'J', b'O', b'E', 0],
    [b'J', b'O', b'G', 0],
    [b'J', b'O', b'T', 0],
    [b'J', b'O', b'Y', 0],
    [b'